---
title: "Analytics Events"
description: "Event descriptions"
layout: article
category: Reporting
---

{% if site.env.BRANCH == 'main' %}
  {% assign idp_base_url = site.env.IDP_BASE_URL %}
{% else %}
  {% assign idp_base_url = site.env.IDP_BASE_URL_PREVIEW %}
{% endif %}

{% assign idp_base_url = idp_base_url | default: 'https://secure.login.gov' %}

<div markdown="1">
These are the events that are documented in the IDP. Each event has can have custom
properties that go under `event_properties` in the final payload:

```json
{
  "name": "Event Name",
  "user_id": "some-user-id",
  "properties": {
    "event_properties": {}
  }
}
```
</div>

<div
  id="events-container"
  data-idp-base-url="{{ idp_base_url }}">
</div>

<template data-template-name="event-template">
  <h3 data-item="event_name"></h3>
  <p data-item="description"></p>

  <h4 data-hidden-if-empty="attributes">Attributes</h4>
  <ul data-each="attributes"></ul>

  <h4>Example</h4>
  <code><pre data-item="example"></pre></code>
</template>

<template data-template-name="attribute-template">
  <li>
    <kbd data-item="name"></kbd>
    <span data-item="types"></span>
    <p data-item="description"></p>
  </li>
</template>

<template data-template-name="sidenav-item-template">
  <li class="usa-sidenav__item">
    <a></a>
  </li>
</template>

<script type="text/javascript">
  function loadAnalyticsEvents() {
    const container = document.querySelector('#events-container');
    const eventTemplate = document.querySelector('[data-template-name=event-template]');
    const attributeTemplate = document.querySelector('[data-template-name=attribute-template]');
    const sideNavItemTemplate = document.querySelector('[data-template-name=sidenav-item-template]');
    const sideNav = document.querySelector('#sidenav');

    if (!container || !eventTemplate || !attributeTemplate || !sideNavItemTemplate) {
      return;
    }

    function buildAttributeElem({ name, types, description }) {
      const attributeElem = attributeTemplate.content.cloneNode(true);

      attributeElem.querySelector('[data-item=name]').innerText = name;
      attributeElem.querySelector('[data-item=types]').innerText = types;
      attributeElem.querySelector('[data-item=description]').innerText = description;

      return attributeElem;
    }

    /**
     * @return {string}
     */
    function buildExample({ event_name, attributes }) {
      const attributeExamples = attributes.map(({ name, types, description }) => {
        const key = JSON.stringify(name);
        const value = types.flatMap((type) => {
          switch(type) {
            case 'Boolean':
              return ['true', 'false'];
            case 'Integer':
              return 0;
            case 'Hash':
              return '{}';
            default:
              return type;
          }
        }).join(' | ');

        let example = `${key}: ${value},`;

        if (description) {
          example += ` // ${description}`;
        }

        return example;
      });

      if (attributeExamples.length) {
        attributeExamples.unshift('');
        attributeExamples.push('');
      }

      const eventProperties = attributeExamples.
        join("\n      ").
        replace(/(  $)/, ''); // fix last line indentation

      const example = `{
  "name": ${JSON.stringify(event_name)},
  "properties": {
    "event_properties": {${eventProperties}}
  }
}`;
      return example;
    }

    function buildEventElem({ event_name, description, attributes }) {
      const elem = eventTemplate.content.cloneNode(true);

      elem.querySelector('[data-item=event_name]').innerText = event_name;
      elem.querySelector('[data-item=description]').innerText = description;

      elem.querySelector('[data-hidden-if-empty=attributes]').hidden = (attributes.length === 0);

      const attributesList = elem.querySelector('[data-each=attributes]');

      attributes.sort(({ name: a }, { name: b }) => a.localeCompare(b))
        .forEach((attribute) => attributesList.appendChild(buildAttributeElem(attribute)));

      elem.querySelector('[data-item=example]').innerText = buildExample({ event_name, attributes })

      return elem;
    }

    function buildSidenavItemElem({ event_name }) {
      const elem = sideNavItemTemplate.content.cloneNode(true);

      const a = elem.querySelector('a');
      a.href = `#${anchors.urlify(event_name)}`;
      a.innerText = event_name;

      return elem;
    }

    const { idpBaseUrl } = container.dataset;
    window.fetch(`${idpBaseUrl}/api/analytics-events.json`)
      .then((response) => response.json())
      .then(({ events }) => {
        events.sort(({ event_name: a}, { event_name: b}) => a.localeCompare(b))
          .forEach((event) => {
            container.appendChild(buildEventElem(event))
            sideNav.appendChild(buildSidenavItemElem(event))
          });

        if (typeof setUpAnchors !== 'undefined') {
          setUpAnchors();
        }

        if (document.location.hash) {
          const target = document.querySelector(document.location.hash);
          if (target) {
            target.scrollIntoView();
          }
        }
      });
  }

  loadAnalyticsEvents();
</script>